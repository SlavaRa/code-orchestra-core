package jetbrains.mps.baseLanguage.closures.generator.baseLanguage.template.helper;

/*Generated by MPS */

import java.util.List;
import jetbrains.mps.smodel.SNode;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import java.util.ArrayList;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;

public class StatementListUtil {
  public static List<SNode> selectStatementsUntilControlStatement(SNode slist) {
    if (ListSequence.fromList(SLinkOperations.getTargets(slist, "statement", true)).count() > 0) {
      return selectStatementsUntilControlStatement(slist, ListSequence.fromList(((List<SNode>) SLinkOperations.getTargets(slist, "statement", true))).getElement(0));
    }
    return ListSequence.fromList(new ArrayList<SNode>());
  }

  public static List<SNode> selectStatementsUntilControlStatement(SNode slist, SNode start) {
    List<SNode> res = ListSequence.fromList(new ArrayList<SNode>());
    boolean foundStart = false;
    for (SNode stmt : ((List<SNode>) SLinkOperations.getTargets(slist, "statement", true))) {
      if (stmt == start) {
        foundStart = true;
      }
      if (foundStart) {
        if (isControlStatement(stmt)) {
          break;
        }
        if (!(isIgnoredStatement(stmt))) {
          ListSequence.fromList(res).addElement(stmt);
        }
      }
    }
    return res;
  }

  public static SNode nextSibling(SNode stmt) {
    SNode nextSibling = SNodeOperations.cast(SNodeOperations.getNextSibling(stmt), "jetbrains.mps.baseLanguage.structure.Statement");
    while ((nextSibling != null) && isIgnoredStatement(nextSibling)) {
      nextSibling = SNodeOperations.cast(SNodeOperations.getNextSibling(nextSibling), "jetbrains.mps.baseLanguage.structure.Statement");
    }
    return nextSibling;
  }

  public static boolean isControlStatement(SNode stmt) {
    if (SNodeOperations.isInstanceOf(stmt, "jetbrains.mps.baseLanguage.structure.WhileStatement")) {
      return true;
    }
    if (SNodeOperations.isInstanceOf(stmt, "jetbrains.mps.baseLanguage.structure.DoWhileStatement")) {
      return true;
    }
    if (SNodeOperations.isInstanceOf(stmt, "jetbrains.mps.baseLanguage.structure.ForStatement")) {
      return true;
    }
    if (SNodeOperations.isInstanceOf(stmt, "jetbrains.mps.baseLanguage.structure.ForeachStatement")) {
      return true;
    }
    if (SNodeOperations.isInstanceOf(stmt, "jetbrains.mps.baseLanguage.structure.SwitchStatement")) {
      return true;
    }
    if (SNodeOperations.isInstanceOf(stmt, "jetbrains.mps.baseLanguage.structure.IfStatement")) {
      return true;
    }
    if (SNodeOperations.isInstanceOf(stmt, "jetbrains.mps.baseLanguage.closures.structure.YieldStatement")) {
      return true;
    }
    return false;
  }

  public static boolean isIgnoredStatement(SNode stmt) {
    if (SNodeOperations.isInstanceOf(stmt, "jetbrains.mps.baseLanguage.structure.BlockStatement")) {
      return true;
    }
    return false;
  }
}
