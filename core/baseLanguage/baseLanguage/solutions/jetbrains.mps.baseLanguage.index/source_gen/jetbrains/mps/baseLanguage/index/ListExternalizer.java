package jetbrains.mps.baseLanguage.index;

/*Generated by MPS */

import com.intellij.util.io.DataExternalizer;
import java.util.List;
import java.io.DataOutput;
import java.io.IOException;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.io.DataInput;
import java.util.ArrayList;

public class ListExternalizer<T> implements DataExternalizer<List<T>> {
  private DataExternalizer<T> myInnerExternalizer;

  public ListExternalizer(DataExternalizer<T> innerExternalizer) {
    myInnerExternalizer = innerExternalizer;
  }

  public void save(DataOutput output, List<T> elements) throws IOException {
    output.writeInt(ListSequence.fromList(elements).count());
    for (T element : elements) {
      myInnerExternalizer.save(output, element);
    }
  }

  public List<T> read(DataInput input) throws IOException {
    List<T> result = ListSequence.fromList(new ArrayList<T>());
    for (int i = input.readInt(); i > 0; i--) {
      ListSequence.fromList(result).addElement(myInnerExternalizer.read(input));
    }
    return result;
  }
}
