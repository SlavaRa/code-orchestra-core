package jetbrains.mps.baseLanguage.unitTest.plugin;

/*Generated by MPS */

import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.smodel.SNodePointer;
import jetbrains.mps.smodel.SModel;
import jetbrains.mps.internal.collections.runtime.Sequence;
import java.util.Collections;
import jetbrains.mps.project.IModule;
import org.apache.commons.lang.StringUtils;
import jetbrains.mps.project.MPSProject;

public enum JUnitRunTypes2 {
  METHOD() {

    public Iterable<ITestNodeWrapper> collect(JUnitTests_Configuration configuration) {
      return TestUtils.wrapPointerStrings(configuration.getTestMethods());
    }

    public String check(JUnitTests_Configuration configuration) {
      if ((configuration.getTestMethods() == null || configuration.getTestMethods().isEmpty())) {
        return "Methods list is empty.";
      }
      if (configuration.getTestMethods() != null) {
        for (String method : ListSequence.fromList(configuration.getTestMethods())) {
          SNodePointer pointer = TestUtils.stringToPointer(method);
          if (pointer == null || pointer.getNode() == null || TestNodeWrapperFactory.tryToWrap(pointer.getNode()) == null) {
            return "Could not find test method for id " + method + ".";
          }
        }
      }
      return null;
    }

  },
  NODE() {

    public Iterable<ITestNodeWrapper> collect(JUnitTests_Configuration configuration) {
      return TestUtils.wrapPointerStrings(configuration.getTestCases());
    }

    public String check(JUnitTests_Configuration configuration) {
      if ((configuration.getTestCases() == null || configuration.getTestCases().isEmpty())) {
        return "Classes list is empty.";
      }
      if (configuration.getTestCases() != null) {
        for (String testCase : ListSequence.fromList(configuration.getTestCases())) {
          SNodePointer pointer = TestUtils.stringToPointer(testCase);
          if (pointer == null || pointer.getNode() == null || TestNodeWrapperFactory.tryToWrap(pointer.getNode()) == null) {
            return "Could not find test case for id " + testCase + ".";
          }
        }
      }
      return null;
    }

  },
  MODEL() {

    public Iterable<ITestNodeWrapper> collect(JUnitTests_Configuration configuration) {
      SModel model = TestUtils.getModel(configuration.getModel());
      if (model == null) {
        return Sequence.fromIterable(Collections.<ITestNodeWrapper>emptyList());
      }
      return TestUtils.getModelTests(model);
    }

    public String check(JUnitTests_Configuration configuration) {
      if (configuration.getModel() == null) {
        return "Model is not selected.";
      }
      SModel model = TestUtils.getModel(configuration.getModel());
      if (model == null) {
        return "Could not find model " + configuration.getModel();
      }
      if (Sequence.fromIterable(TestUtils.getModelTests(model)).isEmpty()) {
        return "No tests found in model " + configuration.getModel() + ".";
      }
      return null;
    }

  },
  MODULE() {

    public Iterable<ITestNodeWrapper> collect(JUnitTests_Configuration configuration) {
      IModule module = TestUtils.getModule(configuration.getModule());
      if (module == null) {
        return Sequence.fromIterable(Collections.<ITestNodeWrapper>emptyList());
      }
      return TestUtils.getModuleTests(module);
    }

    public String check(JUnitTests_Configuration configuration) {
      if (StringUtils.isEmpty(configuration.getModule())) {
        return "Module is not selected.";
      }
      IModule module = TestUtils.getModule(configuration.getModule());
      if (module == null) {
        return "Module " + configuration.getModule() + " does not exist.";
      }
      if (Sequence.fromIterable(TestUtils.getModuleTests(module)).isEmpty()) {
        return "No tests found in module " + configuration.getModule() + "";
      }
      return null;
    }

  },
  PROJECT() {

    public Iterable<ITestNodeWrapper> collect(JUnitTests_Configuration configuration) {
      return TestUtils.getProjectTests(configuration.getProject().getComponent(MPSProject.class));
    }

    public String check(JUnitTests_Configuration configuration) {
      if (Sequence.fromIterable(TestUtils.getProjectTests(configuration.getProject().getComponent(MPSProject.class))).isEmpty()) {
        return "Project does not contain tests.";
      }
      return null;
    }

  };

  JUnitRunTypes2() {
  }

  public abstract Iterable<ITestNodeWrapper> collect(JUnitTests_Configuration configuration);

  public abstract String check(JUnitTests_Configuration cofiguration);
}
