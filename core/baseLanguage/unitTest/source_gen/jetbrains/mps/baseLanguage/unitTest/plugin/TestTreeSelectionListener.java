package jetbrains.mps.baseLanguage.unitTest.plugin;

/*Generated by MPS */

import javax.swing.event.TreeSelectionListener;
import javax.swing.tree.TreeSelectionModel;
import javax.swing.event.TreeSelectionEvent;
import javax.swing.tree.TreePath;

public class TestTreeSelectionListener implements TreeSelectionListener {
  private TreeSelectionModel treeSelectionModel;
  private StatisticsTableModel statisticsModel;
  private TestOutputComponent outputComponent;

  public TestTreeSelectionListener(TestTree tree, StatisticsTableModel statistics, TestOutputComponent outputComponent) {
    this.treeSelectionModel = tree.getSelectionModel();
    this.statisticsModel = statistics;
    this.outputComponent = outputComponent;
  }

  public void valueChanged(TreeSelectionEvent event) {
    if (event.getNewLeadSelectionPath() == null) {
      return;
    }
    TreePath path = this.treeSelectionModel.getSelectionPath();
    if (path == null) {
      return;
    }
    String className = null;
    String methodName = null;
    Object node = path.getLastPathComponent();
    if (node instanceof TestCaseTreeNode) {
      TestCaseTreeNode n = (TestCaseTreeNode) node;
      className = n.getClassName();
    } else if (node instanceof TestMethodTreeNode) {
      TestMethodTreeNode n = (TestMethodTreeNode) node;
      className = n.getClassName();
      methodName = n.getMethodName();
    }
    this.outputComponent.filter(className, methodName);
    this.statisticsModel.setFilter(className, methodName);
  }
}
