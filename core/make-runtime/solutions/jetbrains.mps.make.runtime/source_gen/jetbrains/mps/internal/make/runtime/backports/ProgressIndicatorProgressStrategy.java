package jetbrains.mps.internal.make.runtime.backports;

/*Generated by MPS */

import jetbrains.mps.internal.make.runtime.script.AbstractProgressStrategy;
import com.intellij.openapi.progress.ProgressIndicator;

public class ProgressIndicatorProgressStrategy extends AbstractProgressStrategy {
  private static final String TOTAL = "__TOTAL__";

  private ProgressIndicator pind;

  public ProgressIndicatorProgressStrategy() {
    super(TOTAL);
  }

  public void setProgressIndicator(ProgressIndicator pi) {
    this.pind = pi;
    pi.setIndeterminate(false);
  }

  public ProgressIndicator getProgressIndicator() {
    return pind;
  }

  protected void begunWork(AbstractProgressStrategy.Work wrk) {
    pind.setText(wrk.name());
    pind.setText2("");
  }

  protected void advancedWork(AbstractProgressStrategy.Work wrk) {
    if (wrk == lastProgress()) {
      pind.setFraction(wrk.matchingOrTotal(TOTAL).doneRatio());
      pind.setText((wrk.comment() != null ?
        wrk.name() + " " + wrk.comment() :
        wrk.name()
      ));
    }
  }

  protected void finishedWork(AbstractProgressStrategy.Work wrk) {
    pind.setText("");
    pind.setText2("");
  }
}
