package jetbrains.mps.vcs.diff.ui;

/*Generated by MPS */

import jetbrains.mps.workbench.action.BaseAction;
import com.intellij.openapi.diff.DiffRequest;
import jetbrains.mps.ide.dialogs.BaseDialog;
import jetbrains.mps.ide.projectPane.Icons;
import com.intellij.openapi.actionSystem.AnActionEvent;
import java.util.Map;
import com.intellij.openapi.diff.DiffTool;
import com.intellij.openapi.diff.DiffManager;

public class InvokeTextDiffAction extends BaseAction {
  private DiffRequest myDiffRequest;
  private BaseDialog myDialog;

  public InvokeTextDiffAction(String title, String description, BaseDialog dialog, DiffRequest diffRequest) {
    super(title, description, Icons.TEXT_ICON);
    myDialog = dialog;
    myDiffRequest = diffRequest;
    setDisableOnNoProject(false);
    setExecuteOutsideCommand(true);
  }

  protected void doExecute(AnActionEvent event, Map<String, Object> map) {
    DiffTool ideaDiffTool = DiffManager.getInstance().getIdeaDiffTool();
    if (ideaDiffTool.canShow(myDiffRequest)) {
      myDialog.dispose();
      ideaDiffTool.show(myDiffRequest);
    }
  }
}
