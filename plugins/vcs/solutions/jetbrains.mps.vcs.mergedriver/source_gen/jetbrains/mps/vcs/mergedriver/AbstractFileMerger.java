package jetbrains.mps.vcs.mergedriver;

/*Generated by MPS */

import java.io.File;
import java.io.OutputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;

/*package*/ abstract class AbstractFileMerger {
  public static final int MERGED = 0;
  public static final int CONFLICTS = 1;
  public static final int FATAL_ERROR = 2;

  protected boolean myOverwrite;
  protected byte[] myConflictStart;
  protected byte[] myConflictEnd;
  protected byte[] mySeparator;

  /*package*/ AbstractFileMerger() {
  }

  public final int mergeFiles(File baseFile, File localFile, File latestFile, boolean overwrite, byte[] conflictStart, byte[] conflictEnd, byte[] separator) {
    myOverwrite = overwrite;
    myConflictStart = conflictStart;
    myConflictEnd = conflictEnd;
    mySeparator = separator;
    return mergeFiles(baseFile, localFile, latestFile);
  }

  protected abstract int mergeFiles(File baseFile, File localFile, File latestFile);

  protected OutputStream getResultStream(File rewritable) throws FileNotFoundException {
    return (myOverwrite ?
      new FileOutputStream(rewritable) :
      System.out
    );
  }
}
