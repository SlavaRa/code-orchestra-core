package jetbrains.mps.nanoc.debug;

/*Generated by MPS */

import com.intellij.execution.process.ProcessHandler;
import java.io.File;

public class GDBCommands {
  public GDBCommands() {
  }

  public void startProcessUnderGDB(ProcessHandler gdbProcess, String command) {
    File programFile = new File(command);
    File dir = programFile.getParentFile();
    String workingDir = dir.getAbsolutePath();
    ProcessUtil.inputWithFlush(gdbProcess, "-environment-cd " + workingDir + "\n");
    ProcessUtil.inputWithFlush(gdbProcess, "-file-exec-and-symbols " + command.replace(File.separatorChar, '/') + "\n");
    ProcessUtil.inputWithFlush(gdbProcess, "-break-insert main\n");
    ProcessUtil.inputWithFlush(gdbProcess, "-exec-run\n");
  }

  public void stopProcessUnderGDB(ProcessHandler gdbProcess) {
    ProcessUtil.inputWithFlush(gdbProcess, "kill\n");
  }
}
