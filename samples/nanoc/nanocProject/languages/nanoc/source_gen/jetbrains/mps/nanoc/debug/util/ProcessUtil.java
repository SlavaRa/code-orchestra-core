package jetbrains.mps.nanoc.debug.util;

/*Generated by MPS */

import java.lang.reflect.Field;

public class ProcessUtil {
  public ProcessUtil() {
  }

  public static String getProcessId(Process p) {
    Long l = ProcessUtil.getWinProcessId(p);
    if (l != null) {
      return "" + l.longValue();
    }
    Integer i = ProcessUtil.getUnixProcessId(p);
    if (i != null) {
      return "" + i.longValue();
    }
    return null;
  }

  private static Long getWinProcessId(Process p) {
    try {
      Field f = p.getClass().getDeclaredField("handle");
      f.setAccessible(true);
      Long l = (Long) f.get(p);
      return l;
    } catch (Throwable t) {
      return null;
    }
  }

  private static Integer getUnixProcessId(Process p) {
    try {
      Field f = p.getClass().getDeclaredField("pid");
      f.setAccessible(true);
      Integer i = (Integer) f.get(p);
      return i;
    } catch (Throwable t) {
      return null;
    }
  }
}
